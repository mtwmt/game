import{a as L,b as M}from"./chunk-LZO5OIE5.js";import{A as O,B as S,C as o,D as r,E as h,I as k,J as c,L as m,R as s,S as v,T as y,X as P,a as w,ba as G,ca as B,da as I,h as p,i as b,m as u,r as C,s as l,t as T,v as f,w as _,y as D,z as E}from"./chunk-DHV5LGN5.js";var R=a=>({"grid-template-columns":a});function F(a,t){if(a&1){let e=k();o(0,"button",25),c("click",function(){p(e);let n=m();return b(n.startGame())}),s(1," \u958B\u59CB\u904A\u6232 "),r()}}function H(a,t){if(a&1){let e=k();o(0,"button",26),c("click",function(){p(e);let n=m();return b(n.resetGame())}),s(1," \u91CD\u65B0\u958B\u59CB "),r()}}function V(a,t){if(a&1){let e=k();o(0,"button",27),c("click",function(){p(e);let n=m();return b(n.togglePause())}),s(1),r()}if(a&2){let e=m();l(),y(" ",e.isPaused()?"\u7E7C\u7E8C":"\u66AB\u505C"," ")}}function z(a,t){if(a&1&&h(0,"div",9),a&2){let e=t.$implicit,i=m();S("ngClass",i.getCellClass(i.getCol(e),i.getRow(e)))}}function A(a,t){if(a&1){let e=k();o(0,"button",28),c("click",function(){p(e);let n=m();return b(n.startGame())}),s(1," \u958B\u59CB\u904A\u6232 "),r()}}function U(a,t){if(a&1){let e=k();o(0,"button",29),c("click",function(){p(e);let n=m();return b(n.togglePause())}),s(1),r()}if(a&2){let e=m();l(),y(" ",e.isPaused()?"\u7E7C\u7E8C":"\u66AB\u505C"," ")}}var N=class a{boardSize=20;snake=u([{x:10,y:10}]);food=u({x:5,y:5});direction=u("RIGHT");score=u(0);gameOver=u(!1);gameStarted=u(!1);isPaused=u(!1);gameRules={title:"\u8CAA\u98DF\u86C7\u904A\u6232\u898F\u5247",rules:["\u4F7F\u7528\u65B9\u5411\u9375 (\u2191\u2193\u2190\u2192) \u6216\u89F8\u63A7\u6ED1\u52D5\u63A7\u5236\u86C7\u7684\u79FB\u52D5\u65B9\u5411","\u5403\u5230\u7D05\u8272\u98DF\u7269\u53EF\u4EE5\u589E\u52A0\u5206\u6578\u4E26\u8B93\u86C7\u8EAB\u8B8A\u9577","\u907F\u514D\u649E\u5230\u908A\u754C\u7246\u58C1\u6216\u86C7\u8EAB\u672C\u9AD4\uFF0C\u5426\u5247\u904A\u6232\u7D50\u675F","\u6309\u7A7A\u767D\u9375\u53EF\u4EE5\u66AB\u505C/\u7E7C\u7E8C\u904A\u6232","\u904A\u6232\u76EE\u6A19\u662F\u7372\u5F97\u6700\u9AD8\u5206\u6578\uFF0C\u6311\u6230\u81EA\u5DF1\u7684\u6975\u9650","\u86C7\u79FB\u52D5\u901F\u5EA6\u56FA\u5B9A\uFF0C\u9700\u8981\u63D0\u524D\u9810\u5224\u8DEF\u7DDA"]};gameLoop;gameSpeed=150;touchStartX=0;touchStartY=0;minSwipeDistance=30;ngOnInit(){this.generateFood()}ngOnDestroy(){this.gameLoop&&clearInterval(this.gameLoop)}handleKeyPress(t){if(!this.gameStarted()&&t.key===" "){this.startGame();return}if(this.gameOver()&&t.key===" "){this.resetGame();return}if(this.gameStarted()&&!this.gameOver()&&t.key===" "){this.togglePause();return}if(!this.gameStarted()||this.gameOver()||this.isPaused())return;let e=this.direction();switch(t.key){case"ArrowUp":e!=="DOWN"&&this.direction.set("UP");break;case"ArrowDown":e!=="UP"&&this.direction.set("DOWN");break;case"ArrowLeft":e!=="RIGHT"&&this.direction.set("LEFT");break;case"ArrowRight":e!=="LEFT"&&this.direction.set("RIGHT");break}}startGame(){this.gameStarted.set(!0),this.gameLoop=setInterval(()=>this.moveSnake(),this.gameSpeed)}resetGame(){this.snake.set([{x:10,y:10}]),this.direction.set("RIGHT"),this.score.set(0),this.gameOver.set(!1),this.gameStarted.set(!1),this.isPaused.set(!1),this.generateFood(),this.gameLoop&&clearInterval(this.gameLoop)}togglePause(){this.isPaused()?this.resumeGame():this.pauseGame()}pauseGame(){this.isPaused.set(!0),this.gameLoop&&(clearInterval(this.gameLoop),this.gameLoop=void 0)}resumeGame(){this.isPaused.set(!1),this.gameStarted()&&!this.gameOver()&&(this.gameLoop=setInterval(()=>this.moveSnake(),this.gameSpeed))}moveSnake(){let t=this.snake(),e=w({},t[0]);switch(this.direction()){case"UP":e.y--;break;case"DOWN":e.y++;break;case"LEFT":e.x--;break;case"RIGHT":e.x++;break}if(this.checkCollision(e)){this.endGame();return}let i=[e,...t];e.x===this.food().x&&e.y===this.food().y?(this.score.update(n=>n+10),this.generateFood()):i.pop(),this.snake.set(i)}checkCollision(t){return t.x<0||t.x>=this.boardSize||t.y<0||t.y>=this.boardSize?!0:this.snake().some(e=>e.x===t.x&&e.y===t.y)}generateFood(){let t;do t={x:Math.floor(Math.random()*this.boardSize),y:Math.floor(Math.random()*this.boardSize)};while(this.snake().some(e=>e.x===t.x&&e.y===t.y));this.food.set(t)}endGame(){this.gameOver.set(!0),this.gameLoop&&clearInterval(this.gameLoop)}getCellClass(t,e){let i=this.snake().length>0&&this.snake()[0].x===t&&this.snake()[0].y===e,n=this.snake().some(g=>g.x===t&&g.y===e),d=this.food().x===t&&this.food().y===e,x=!i&&!n&&!d;return i?"bg-lime-400 border border-lime-600 ":n?"bg-lime-600 border border-lime-500":d?"bg-fuchsia-500 shadow-[0_0_6px_#c026d3,0_0_12px_#c026d3] animate-pulse":x?"bg-lime-900":""}getBoard(){return Array(this.boardSize*this.boardSize).fill(0).map((t,e)=>e)}getRow(t){return Math.floor(t/this.boardSize)}getCol(t){return t%this.boardSize}onTouchStart(t){t.preventDefault();let e=t.touches[0];this.touchStartX=e.clientX,this.touchStartY=e.clientY}onTouchMove(t){t.preventDefault()}onTouchEnd(t){if(!this.gameStarted()||this.gameOver()||this.isPaused())return;t.preventDefault();let e=t.changedTouches[0],i=e.clientX-this.touchStartX,n=e.clientY-this.touchStartY,d=Math.abs(i),x=Math.abs(n);if(Math.max(d,x)<this.minSwipeDistance)return;let g=this.direction();d>x?i>0&&g!=="LEFT"?this.direction.set("RIGHT"):i<0&&g!=="RIGHT"&&this.direction.set("LEFT"):n>0&&g!=="UP"?this.direction.set("DOWN"):n<0&&g!=="DOWN"&&this.direction.set("UP")}changeDirection(t){if(!this.gameStarted()||this.gameOver()||this.isPaused())return;let e=this.direction();({UP:"DOWN",DOWN:"UP",LEFT:"RIGHT",RIGHT:"LEFT"})[e]!==t&&this.direction.set(t)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=T({type:a,selectors:[["app-snake"]],hostBindings:function(e,i){e&1&&c("keydown",function(d){return i.handleKeyPress(d)},C)},decls:45,vars:14,consts:[[1,"w-full","max-w-sm","mx-auto","flex","flex-col"],[1,"mb-2","flex","flex-col","gap-3","items-stretch"],["title","\u8CAA\u98DF\u86C7",3,"gameRules"],[1,"flex","gap-2"],[1,"h-12","w-1/2","rounded-md","bg-lime-700","border","border-lime-500","text-lime-50","font-semibold","text-base","shadow","hover:bg-lime-600","focus:outline-none","focus:ring-2","focus:ring-lime-300"],[1,"h-12","w-1/2","rounded-md","bg-cyan-700","border","border-cyan-500","text-cyan-50","font-semibold","text-base","shadow","hover:bg-cyan-600","focus:outline-none","focus:ring-2","focus:ring-cyan-300"],[1,"h-12","w-1/2","rounded-md","bg-yellow-700","border","border-yellow-500","text-yellow-50","font-semibold","text-base","shadow","hover:bg-yellow-600","focus:outline-none","focus:ring-2","focus:ring-yellow-300"],[1,"h-12","w-1/2","rounded-md","bg-zinc-800","border","border-zinc-600","text-lime-200","font-medium","shadow","hover:bg-zinc-700","focus:outline-none","focus:ring-2","focus:ring-lime-300"],[1,"inline-grid","grid-cols-12","gap-[2px]","p-2","bg-green-900/40","border","border-green-800","touch-none","select-none",3,"touchstart","touchmove","touchend","ngStyle"],[1,"w-3","h-3",3,"ngClass"],[1,"md:hidden","fixed","inset-x-0","bottom-0","z-40","px-4","pb-4","pt-3","bg-black/70","backdrop-blur-sm","flex","justify-center","gap-6","transition-opacity"],[1,"grid","grid-cols-3","grid-rows-3","gap-1"],[1,"gb-pad","h-16","w-16","flex","items-center","justify-center","bg-lime-900","border","border-lime-700","text-lime-400","active:scale-95",3,"click"],["data-key","ArrowLeft",1,"gb-pad","h-16","w-16","flex","items-center","justify-center","bg-lime-900","border","border-lime-700","text-lime-400","active:scale-95",3,"click"],[1,"h-16","w-16"],[1,"absolute","bottom-0","right-0","m-4"],[1,"border","border-lime-800","bg-lime-900","p-2","text-lime-400","font-bold","hover:bg-lime-400/30","transition"],[1,"border","border-yellow-800","bg-yellow-900","p-2","text-yellow-400","font-bold","hover:bg-yellow-300/30","transition"],["theme","lime",3,"close","isOpen","showCloseButton","closeOnBackdrop"],[1,"text-3xl","mb-4"],[1,"text-2xl","font-bold","mb-2","text-lime-100"],[1,"rounded-lg","p-3","mb-6","bg-lime-700/50"],[1,"text-lime-200"],[1,"font-bold","text-2xl","text-lime-100"],[1,"bg-lime-400","hover:bg-lime-300","text-lime-900","font-bold","py-3","px-6","rounded-lg","transition-all","duration-200","transform","hover:scale-105","shadow-lg",3,"click"],[1,"h-12","w-1/2","rounded-md","bg-lime-700","border","border-lime-500","text-lime-50","font-semibold","text-base","shadow","hover:bg-lime-600","focus:outline-none","focus:ring-2","focus:ring-lime-300",3,"click"],[1,"h-12","w-1/2","rounded-md","bg-cyan-700","border","border-cyan-500","text-cyan-50","font-semibold","text-base","shadow","hover:bg-cyan-600","focus:outline-none","focus:ring-2","focus:ring-cyan-300",3,"click"],[1,"h-12","w-1/2","rounded-md","bg-yellow-700","border","border-yellow-500","text-yellow-50","font-semibold","text-base","shadow","hover:bg-yellow-600","focus:outline-none","focus:ring-2","focus:ring-yellow-300",3,"click"],[1,"border","border-lime-800","bg-lime-900","p-2","text-lime-400","font-bold","hover:bg-lime-400/30","transition",3,"click"],[1,"border","border-yellow-800","bg-yellow-900","p-2","text-yellow-400","font-bold","hover:bg-yellow-300/30","transition",3,"click"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"header",1),h(2,"app-game-header",2),o(3,"div",3),f(4,F,2,0,"button",4),f(5,H,2,0,"button",5),f(6,V,2,1,"button",6),o(7,"button",7),s(8," \u5206\u6578 ("),o(9,"span"),s(10),r(),s(11,") "),r()()(),o(12,"main",8),c("touchstart",function(d){return i.onTouchStart(d)})("touchmove",function(d){return i.onTouchMove(d)})("touchend",function(d){return i.onTouchEnd(d)}),E(13,z,1,1,"div",9,D),r(),o(15,"div",10)(16,"div",11),h(17,"span"),o(18,"button",12),c("click",function(){return i.changeDirection("UP")}),s(19," \u25B2 "),r(),h(20,"span"),o(21,"button",13),c("click",function(){return i.changeDirection("LEFT")}),s(22," \u25C0 "),r(),h(23,"span",14),o(24,"button",12),c("click",function(){return i.changeDirection("RIGHT")}),s(25," \u25B6 "),r(),h(26,"span"),o(27,"button",12),c("click",function(){return i.changeDirection("DOWN")}),s(28," \u25BC "),r(),h(29,"span"),r(),o(30,"div",15),f(31,A,2,0,"button",16),f(32,U,2,1,"button",17),r()(),o(33,"app-modal",18),c("close",function(){return i.resetGame()}),o(34,"div",19),s(35,"\u{1F480}"),r(),o(36,"h2",20),s(37,"\u904A\u6232\u7D50\u675F"),r(),o(38,"div",21)(39,"div",22),s(40,"\u6700\u7D42\u5206\u6578"),r(),o(41,"div",23),s(42),r()(),o(43,"button",24),c("click",function(){return i.resetGame()}),s(44," \u91CD\u65B0\u958B\u59CB "),r()()()),e&2&&(l(2),S("gameRules",i.gameRules),l(2),_(!i.gameStarted()&&!i.gameOver()?4:-1),l(),_(i.gameOver()?5:-1),l(),_(i.gameStarted()&&!i.gameOver()?6:-1),l(4),v(i.score()),l(2),S("ngStyle",P(12,R,"repeat("+i.boardSize+", minmax(0, 1fr))")),l(),O(i.getBoard()),l(18),_(!i.gameStarted()&&!i.gameOver()?31:-1),l(),_(i.gameStarted()&&!i.gameOver()?32:-1),l(),S("isOpen",i.gameOver())("showCloseButton",!1)("closeOnBackdrop",!1),l(9),v(i.score()))},dependencies:[I,G,B,M,L],encapsulation:2})};export{N as Snake};
