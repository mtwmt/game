<!--  -->
<div class="relative p-2 h-full">
  <div class="text-center">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-lime-400 text-3xl font-bold leading-none">貪食蛇</h1>

      <div class="flex justify-between uppercase mb-1 text-lime-500">
        <span>分數: </span><span>{{ score() }}</span>
      </div>
      <!-- Game Control Buttons -->

      <div class="hidden md:block">
        @if (!gameStarted() && !gameOver()) {
        <button
          class="border border-lime-800 bg-lime-900 p-2 text-lime-400 font-bold hover:bg-lime-400/30 transition"
          (click)="startGame()"
        >
          開始遊戲
        </button>
        } @if (gameOver()) {
        <button
          class="border border-cyan-800 bg-cyan-900 p-2 text-cyan-400 font-bold hover:bg-cyan-400/30 transition"
          (click)="resetGame()"
        >
          重新開始
        </button>
        } @if (gameStarted() && !gameOver()) {
        <button
          class="border border-yellow-800 bg-yellow-900 p-2 text-yellow-400 font-bold hover:bg-yellow-300/30 transition"
          (click)="togglePause()"
        >
          {{ isPaused() ? '繼續' : '暫停' }}
        </button>
        }
      </div>
    </div>

    <!-- <div class="flex justify-center gap-4 text-white my-4">
      <div
        class="border border-lime-400 bg-lime-400/20 px-3 py-3 text-lime-300 font-bold hover:bg-lime-400/30 transition"
      >
        <div class="text-lime-400 text-xl leading-none">分數</div>
        <div>{{ score() }}</div>
      </div>
    </div> -->
  </div>

  <div
    class="inline-grid grid-cols-12 gap-[2px] p-2 bg-green-900/40 border border-green-800 touch-none select-none"
    [ngStyle]="{ 'grid-template-columns': 'repeat(' + boardSize + ', minmax(0, 1fr))' }"
    (touchstart)="onTouchStart($event)"
    (touchmove)="onTouchMove($event)"
    (touchend)="onTouchEnd($event)"
  >
    @for (cell of getBoard(); track cell) {
    <div class="w-3 h-3 sm:w-5 sm:h-5" [ngClass]="getCellClass(getCol(cell), getRow(cell))"></div>
    }
  </div>

  <!-- Mobile Control Buttons -->
  <div
    class="md:hidden fixed inset-x-0 bottom-0 z-40 px-4 pb-4 pt-3 bg-black/70 backdrop-blur-sm flex justify-center gap-6 transition-opacity"
  >
    <!-- <div class=""> -->
    <div class="grid grid-cols-3 grid-rows-3 gap-1">
      <span></span>
      <button
        class="gb-pad h-16 w-16 flex items-center justify-center bg-lime-900 border border-lime-700 text-lime-400 active:scale-95"
        (click)="changeDirection('UP')"
      >
        ▲
      </button>
      <span></span>
      <button
        data-key="ArrowLeft"
        class="gb-pad h-16 w-16 flex items-center justify-center bg-lime-900 border border-lime-700 text-lime-400 active:scale-95"
        (click)="changeDirection('LEFT')"
      >
        ◀
      </button>
      <span class="h-16 w-16"></span>
      <button
        class="gb-pad h-16 w-16 flex items-center justify-center bg-lime-900 border border-lime-700 text-lime-400 active:scale-95"
        (click)="changeDirection('RIGHT')"
      >
        ▶
      </button>
      <span></span>
      <button
        class="gb-pad h-16 w-16 flex items-center justify-center bg-lime-900 border border-lime-700 text-lime-400 active:scale-95"
        (click)="changeDirection('DOWN')"
      >
        ▼
      </button>
      <span></span>
    </div>

    <!-- Game Control Buttons -->
    <div class="absolute bottom-0 right-0 m-4">
      @if (!gameStarted() && !gameOver()) {
      <button
        class="border border-lime-800 bg-lime-900 p-2 text-lime-400 font-bold hover:bg-lime-400/30 transition"
        (click)="startGame()"
      >
        開始遊戲
      </button>
      } @if (gameOver()) {
      <button
        class="border border-cyan-800 bg-cyan-900 p-2 text-cyan-400 font-bold hover:bg-cyan-400/30 transition"
        (click)="resetGame()"
      >
        重新開始
      </button>
      } @if (gameStarted() && !gameOver()) {
      <button
        class="border border-yellow-800 bg-yellow-900 p-2 text-yellow-400 font-bold hover:bg-yellow-300/30 transition"
        (click)="togglePause()"
      >
        {{ isPaused() ? '繼續' : '暫停' }}
      </button>
      }
    </div>
  </div>
</div>
