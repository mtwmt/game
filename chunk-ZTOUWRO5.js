import{A as V,B as A,C as x,D as k,E as T,F as f,G as $,H as P,K as H,L as j,N as X,O as J,Q as y,R as Q,T as Z,U as ee,_ as te,a as g,b as _,c as B,d as z,e as K,f as G,g as N,h as q,i as U,k as Y,o as d,p as W,q as p,r as C,s as F,t as D,u as I,v as E,w as O,x as m,y as u,z as b}from"./chunk-ZLBWINJC.js";var R=(i=>(i.RED="red",i.BLACK="black",i))(R||{});var w=class l{boardCache={kingPositions:new Map,piecesByColor:new Map,lastMoveCount:-1};moveCache=new Map;ORTHOGONAL_DIRECTIONS=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];DIAGONAL_DIRECTIONS=[{dx:-1,dy:-1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:1,dy:1}];initializeBoard(){let e=Array(10).fill(null).map(()=>Array(9).fill(null));return this.setupInitialPieces(e),e}setupInitialPieces(e){let i=["rook","horse","elephant","advisor","king","advisor","elephant","horse","rook"];i.forEach((o,n)=>{let s=this.generatePieceId(o,"red",n);e[9][n]=this.createPiece(s,o,"red",n,9)}),[...i].forEach((o,n)=>{let s=this.generatePieceId(o,"black",n);e[0][n]=this.createPiece(s,o,"black",n,0)}),[1,7].forEach((o,n)=>{e[7][o]=this.createPiece(`r-cannon-${n+1}`,"cannon","red",o,7),e[2][o]=this.createPiece(`b-cannon-${n+1}`,"cannon","black",o,2)});for(let o=0;o<9;o+=2)e[6][o]=this.createPiece(`r-soldier-${o}`,"soldier","red",o,6),e[3][o]=this.createPiece(`b-soldier-${o}`,"soldier","black",o,3)}generatePieceId(e,i,t){let o=i==="red"?"r":"b";return e==="king"?`${o}-king`:`${o}-${e}-${t<4?"1":"2"}`}createPiece(e,i,t,o,n){return{id:e,type:i,color:t,position:{x:o,y:n},isSelected:!1,hasMoved:!1}}initializeGameState(){return{board:this.initializeBoard(),currentPlayer:"red",selectedPiece:null,validMoves:[],gameOver:!1,winner:null,moveHistory:[],isInCheck:!1,isSelfInCheck:!1,isVsAI:!1,aiIsThinking:!1,aiThinkingText:""}}isValidPosition(e,i){return e>=0&&e<9&&i>=0&&i<10}isInPalace(e,i,t){return t==="red"?e>=3&&e<=5&&i>=7&&i<=9:e>=3&&e<=5&&i>=0&&i<=2}isOnOwnSide(e,i){return i==="red"?e>=5:e<=4}wouldKingsFaceEachOther(e,i=0){this.updateBoardCache(e,i);let t=this.boardCache.kingPositions.get("red"),o=this.boardCache.kingPositions.get("black");return!t||!o||t.x!==o.x?!1:this.isPathClear(e,t,o)}isPathClear(e,i,t){let o=Math.min(i.y,t.y),n=Math.max(i.y,t.y);for(let s=o+1;s<n;s++)if(e[s][i.x]!==null)return!1;return!0}updateBoardCache(e,i){if(this.boardCache.lastMoveCount!==i){this.boardCache.kingPositions.clear(),this.boardCache.piecesByColor.clear(),this.boardCache.piecesByColor.set("red",[]),this.boardCache.piecesByColor.set("black",[]);for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e[t][o];n&&(this.boardCache.piecesByColor.get(n.color).push(n),n.type==="king"&&this.boardCache.kingPositions.set(n.color,{x:o,y:t}))}this.boardCache.lastMoveCount=i}}clearCaches(){this.moveCache.clear(),this.boardCache.lastMoveCount=-1}getBoardHash(e){let i="";for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e[t][o];i+=n?`${n.type}${n.color}${o}${t}`:"e"}return i}isValidMoveForPiece(e,i,t){if(!this.isValidPosition(e.x,e.y))return!1;let o=t[e.y][e.x];return!o||o.color!==i.color}getSlidingPieceMoves(e,i,t){let o=[],{x:n,y:s}=e.position;return t.forEach(r=>{for(let a=1;a<10;a++){let c=n+r.dx*a,h=s+r.dy*a;if(!this.isValidPosition(c,h))break;let v=i[h][c];if(v){v.color!==e.color&&o.push({x:c,y:h});break}else o.push({x:c,y:h})}}),o}getPossibleMoves(e,i){let t=`${e.id}-${e.position.x}-${e.position.y}-true`;if(this.moveCache.has(t))return this.moveCache.get(t);let o=this.calculatePieceMoves(e,i,!0);return this.moveCache.set(t,o),o}getPossibleMovesForCheck(e,i){let t=`${e.id}-${e.position.x}-${e.position.y}-false`;if(this.moveCache.has(t))return this.moveCache.get(t);let o=this.calculatePieceMoves(e,i,!1);return this.moveCache.set(t,o),o}calculatePieceMoves(e,i,t){switch(e.type){case"king":return this.getKingMoves(e,i,t);case"advisor":return this.getAdvisorMoves(e,i);case"elephant":return this.getElephantMoves(e,i);case"horse":return this.getHorseMoves(e,i);case"rook":return this.getRookMoves(e,i);case"cannon":return this.getCannonMoves(e,i);case"soldier":return this.getSoldierMoves(e,i);default:return[]}}getKingMoves(e,i,t){let{x:o,y:n}=e.position;return this.ORTHOGONAL_DIRECTIONS.map(r=>({x:o+r.dx,y:n+r.dy})).filter(r=>{if(!this.isValidPosition(r.x,r.y)||!this.isInPalace(r.x,r.y,e.color))return!1;let a=i[r.y][r.x];return a&&a.color===e.color?!1:!t||!this.wouldMoveCreateKingFacing(e,r,i)})}wouldMoveCreateKingFacing(e,i,t){let o=t[i.y][i.x],n=e.position;t[i.y][i.x]=e,t[n.y][n.x]=null,e.position=i;let s=this.wouldKingsFaceEachOther(t);return t[n.y][n.x]=e,t[i.y][i.x]=o,e.position=n,s}getAdvisorMoves(e,i){let{x:t,y:o}=e.position;return this.DIAGONAL_DIRECTIONS.map(s=>({x:t+s.dx,y:o+s.dy})).filter(s=>this.isValidPosition(s.x,s.y)&&this.isInPalace(s.x,s.y,e.color)&&this.isValidMoveForPiece(s,e,i))}getElephantMoves(e,i){let{x:t,y:o}=e.position;return[{x:t-2,y:o-2,block:{x:t-1,y:o-1}},{x:t+2,y:o-2,block:{x:t+1,y:o-1}},{x:t-2,y:o+2,block:{x:t-1,y:o+1}},{x:t+2,y:o+2,block:{x:t+1,y:o+1}}].filter(s=>this.isValidPosition(s.x,s.y)&&this.isOnOwnSide(s.y,e.color)&&!i[s.block.y][s.block.x]&&this.isValidMoveForPiece(s,e,i)).map(s=>({x:s.x,y:s.y}))}getHorseMoves(e,i){let{x:t,y:o}=e.position;return[{x:t-1,y:o-2,block:{x:t,y:o-1}},{x:t+1,y:o-2,block:{x:t,y:o-1}},{x:t-1,y:o+2,block:{x:t,y:o+1}},{x:t+1,y:o+2,block:{x:t,y:o+1}},{x:t-2,y:o-1,block:{x:t-1,y:o}},{x:t-2,y:o+1,block:{x:t-1,y:o}},{x:t+2,y:o-1,block:{x:t+1,y:o}},{x:t+2,y:o+1,block:{x:t+1,y:o}}].filter(s=>this.isValidPosition(s.x,s.y)&&!i[s.block.y][s.block.x]&&this.isValidMoveForPiece(s,e,i)).map(s=>({x:s.x,y:s.y}))}getRookMoves(e,i){return this.getSlidingPieceMoves(e,i,this.ORTHOGONAL_DIRECTIONS)}getCannonMoves(e,i){let t=[],{x:o,y:n}=e.position;return this.ORTHOGONAL_DIRECTIONS.forEach(s=>{let r=!1;for(let a=1;a<10;a++){let c=o+s.dx*a,h=n+s.dy*a;if(!this.isValidPosition(c,h))break;let v=i[h][c];if(v)if(!r)r=!0;else{v.color!==e.color&&t.push({x:c,y:h});break}else r||t.push({x:c,y:h})}}),t}getSoldierMoves(e,i){let t=[],{x:o,y:n}=e.position,s=e.color==="red"?-1:1,r={x:o,y:n+s};return this.isValidMoveForPiece(r,e,i)&&t.push(r),this.isOnOwnSide(n,e.color)||[{x:o-1,y:n},{x:o+1,y:n}].forEach(c=>{this.isValidMoveForPiece(c,e,i)&&t.push(c)}),t}isInCheck(e,i,t=0){this.updateBoardCache(e,t);let o=this.boardCache.kingPositions.get(i);if(!o)return!1;let n=i==="red"?"black":"red";return(this.boardCache.piecesByColor.get(n)||[]).some(r=>this.getPossibleMovesForCheck(r,e).some(c=>c.x===o.x&&c.y===o.y))}makeMove(e,i,t){let{board:o,moveHistory:n}=e,s=o[i.y][i.x];if(!s)return{success:!1};let r=o[t.y][t.x],a=n.length;if(this.clearCaches(),o[t.y][t.x]=s,o[i.y][i.x]=null,s.position=t,r&&r.type==="king")return s.hasMoved=!0,{success:!0,captured:r,isCheck:!1,gameOver:!0,winner:s.color};if(this.wouldKingsFaceEachOther(o,a+1))return s.hasMoved=!0,{success:!0,captured:r||void 0,isCheck:!1,gameOver:!0,winner:s.color==="red"?"black":"red"};let c=s.color==="red"?"black":"red",h=this.isInCheck(o,c,a+1),v=this.isInCheck(o,s.color,a+1);return s.hasMoved=!0,{success:!0,captured:r||void 0,isCheck:h,isSelfInCheck:v}}getPieceSymbol(e){return{king:{red:"\u5E25",black:"\u5C07"},advisor:{red:"\u4ED5",black:"\u58EB"},elephant:{red:"\u76F8",black:"\u8C61"},horse:{red:"\u99AC",black:"\u99AC"},rook:{red:"\u8ECA",black:"\u8ECA"},cannon:{red:"\u70AE",black:"\u7832"},soldier:{red:"\u5175",black:"\u5352"}}[e.type][e.color]}static \u0275fac=function(i){return new(i||l)};static \u0275prov=B({token:l,factory:l.\u0275fac,providedIn:"root"})};var L=class l{constructor(e){this.chessGameService=e;this.loadGameMemory()}gameMemory={playerMoves:[],playerPreferences:{aggressive:.5,defensive:.5,positional:.5},gameCount:0};MAX_DEPTH=3;OPENING_BOOK=[[{from:{x:7,y:2},to:{x:7,y:4},name:"\u4E03\u8DEF\u70AE\u958B\u5C40"},{from:{x:1,y:2},to:{x:1,y:4},name:"\u4E8C\u8DEF\u70AE\u958B\u5C40"}],[{from:{x:2,y:0},to:{x:4,y:2},name:"\u8D77\u98DB\u8C61"},{from:{x:6,y:0},to:{x:4,y:2},name:"\u8D77\u98DB\u8C61"}],[{from:{x:1,y:0},to:{x:2,y:2},name:"\u5DE6\u99AC\u51FA\u52D5"},{from:{x:7,y:0},to:{x:6,y:2},name:"\u53F3\u99AC\u51FA\u52D5"}],[{from:{x:1,y:2},to:{x:4,y:2},name:"\u58EB\u89D2\u70AE"},{from:{x:7,y:2},to:{x:4,y:2},name:"\u58EB\u89D2\u70AE"}]];PATTERNS={ATTACK_PATTERNS:["\u96D9\u8ECA\u6B78\u908A","\u70AE\u6253\u4E2D\u5175","\u99AC\u5F8C\u70AE","\u96D9\u70AE\u904E\u6CB3"],DEFENSE_PATTERNS:["\u5C4F\u98A8\u99AC","\u53CD\u5BAE\u99AC","\u9F9C\u80CC\u70AE","\u9435\u6ED1\u8ECA"]};AI_PERSONALITY={AGGRESSIVE:.8,CAUTIOUS:.6,CREATIVE:.7,CONSISTENCY:.5};PIECE_VALUES={king:1e4,rook:500,cannon:450,horse:400,elephant:200,advisor:200,soldier:100};makeAIMove(e){console.log("\u{1F916} AI\u958B\u59CB\u5206\u6790\u68CB\u5C40...");let i=this.getAllPossibleMoves(e,"black");if(console.log(`\u{1F916} \u627E\u5230 ${i.length} \u500B\u53EF\u80FD\u79FB\u52D5`),i.length===0)return console.log("\u{1F916} AI\u7121\u79FB\u52D5\u53EF\u8D70\uFF0C\u6E96\u5099\u6295\u964D"),null;let t=this.chessGameService.isInCheck(e.board,"black");if(t){console.log("\u{1F916} AI\u88AB\u5C07\u8ECD\uFF01\u512A\u5148\u8003\u616E\u9632\u5B88\u52D5\u4F5C...");let a=this.findEmergencyDefenseMove(e,i);if(a)return console.log(`\u{1F916} AI\u7DCA\u6025\u9632\u5B88: (${a.from.x},${a.from.y}) -> (${a.to.x},${a.to.y})`),a}let o=this.tryOpeningBook(e);if(o)return console.log(`\u{1F916} AI\u4F7F\u7528\u958B\u5C40\u5EAB: ${o.name}`),o;let n=t?Math.min(2,this.MAX_DEPTH):this.MAX_DEPTH;console.log(`\u{1F916} AI${t?"\u88AB\u5C07\u8ECD\uFF0C":""}\u4F7F\u7528\u6DF1\u5EA6 ${n} \u9032\u884C\u641C\u7D22`);let s=this.findBestMoveWithTimeout(e,n,2e4);if(s){let a=this.addMoveVariety(e,s,i);return console.log(`\u{1F916} AI\u6C7A\u5B9A\u79FB\u52D5: (${a.from.x},${a.from.y}) -> (${a.to.x},${a.to.y}), \u8A55\u5206: ${a.score||"varied"}`),{from:a.from,to:a.to}}console.warn("\u{1F916} AI\u7121\u6CD5\u627E\u5230\u6700\u4F73\u79FB\u52D5\u6216\u8D85\u6642\uFF0C\u96A8\u6A5F\u9078\u64C7");let r=i[Math.floor(Math.random()*i.length)];return{from:r.from,to:r.to}}findBestMoveWithTimeout(e,i,t){let o=Date.now(),n=null;try{return this.findBestMoveInternal(e,i,o,t)}catch(s){return console.warn("\u{1F916} AI\u641C\u7D22\u8D85\u6642\u6216\u51FA\u932F:",s),n}}findBestMoveInternal(e,i,t,o){let n=this.getAllPossibleMoves(e,e.currentPlayer);if(n.length===0)return null;let s=null,r=e.currentPlayer==="black"?-1/0:1/0;for(let a of n){if(Date.now()-t>o){console.log("\u{1F916} AI\u641C\u7D22\u8D85\u6642\uFF0C\u8FD4\u56DE\u7576\u524D\u6700\u4F73\u79FB\u52D5");break}let c=this.simulateMove(e,a),h=this.minimaxWithTimeout(c,i-1,-1/0,1/0,e.currentPlayer==="red",t,o);a.score=h,e.currentPlayer==="black"?h>r&&(r=h,s=a):h<r&&(r=h,s=a)}return s}minimaxWithTimeout(e,i,t,o,n,s,r){if(Date.now()-s>r)return this.evaluateBoard(e);if(i===0||e.gameOver)return this.evaluateBoard(e);let a=this.getAllPossibleMoves(e,e.currentPlayer);if(n){let c=-1/0;for(let h of a){if(Date.now()-s>r)break;let v=this.simulateMove(e,h),M=this.minimaxWithTimeout(v,i-1,t,o,!1,s,r);if(c=Math.max(c,M),t=Math.max(t,M),o<=t)break}return c}else{let c=1/0;for(let h of a){if(Date.now()-s>r)break;let v=this.simulateMove(e,h),M=this.minimaxWithTimeout(v,i-1,t,o,!0,s,r);if(c=Math.min(c,M),o=Math.min(o,M),o<=t)break}return c}}findEmergencyDefenseMove(e,i){let t=e.board,o=null;for(let a=0;a<10&&!o;a++)for(let c=0;c<9&&!o;c++){let h=t[a][c];h&&h.color==="black"&&h.type==="king"&&(o=h)}if(!o)return null;let n=i.filter(a=>a.from.x===o.position.x&&a.from.y===o.position.y);for(let a of n){let c=this.simulateMove(e,a);if(!this.chessGameService.isInCheck(c.board,"black"))return{from:a.from,to:a.to}}let s=this.findBlockingMoves(e,i,o);if(s.length>0)return{from:s[0].from,to:s[0].to};let r=this.findCaptureThreatMoves(e,i,o);return r.length>0?{from:r[0].from,to:r[0].to}:null}findBlockingMoves(e,i,t){let o=[],n=this.findThreatsToKing(e.board,t);for(let s of n){let r=this.getInterceptPositions(s.position,t.position);for(let a of i)if(r.some(c=>c.x===a.to.x&&c.y===a.to.y)){let c=this.simulateMove(e,a);this.chessGameService.isInCheck(c.board,"black")||o.push(a)}}return o}findCaptureThreatMoves(e,i,t){let o=[],n=this.findThreatsToKing(e.board,t);for(let s of n)for(let r of i)if(r.to.x===s.position.x&&r.to.y===s.position.y){let a=this.simulateMove(e,r);this.chessGameService.isInCheck(a.board,"black")||o.push(r)}return o}findThreatsToKing(e,i){let t=[];for(let o=0;o<10;o++)for(let n=0;n<9;n++){let s=e[o][n];s&&s.color==="red"&&this.chessGameService.getPossibleMovesForCheck(s,e).some(a=>a.x===i.position.x&&a.y===i.position.y)&&t.push(s)}return t}getInterceptPositions(e,i){let t=[],o=i.x-e.x,n=i.y-e.y;if(o===0){let s=n>0?1:-1;for(let r=e.y+s;r!==i.y;r+=s)t.push({x:e.x,y:r})}else if(n===0){let s=o>0?1:-1;for(let r=e.x+s;r!==i.x;r+=s)t.push({x:r,y:e.y})}return t}tryOpeningBook(e){if(e.moveHistory.length>=6||Math.random()>.3)return null;let t=this.OPENING_BOOK[Math.floor(Math.random()*this.OPENING_BOOK.length)],o=t[Math.floor(Math.random()*t.length)],n=e.board[o.from.y][o.from.x];return n&&n.color==="black"&&this.chessGameService.getPossibleMoves(n,e.board).some(a=>a.x===o.to.x&&a.y===o.to.y)&&!this.wouldMoveCauseSelfCheck(e,o.from,o.to)?{from:o.from,to:o.to,name:o.name}:null}addMoveVariety(e,i,t){if(Math.random()>this.AI_PERSONALITY.CONSISTENCY){for(let r of t){let a=this.simulateMove(e,r);r.score=this.evaluateBoard(a)}t.sort((r,a)=>(a.score||0)-(r.score||0));let o=t.slice(0,3),n=o[0]?.score||0,s=o.filter(r=>Math.abs((r.score||0)-n)<=n*.1);if(s.length>1){let r=s[Math.floor(Math.random()*s.length)];return console.log(`\u{1F916} AI\u9078\u64C7\u8B8A\u5316\u8D70\u6CD5\uFF0C\u5F9E${s.length}\u500B\u76F8\u8FD1\u9078\u9805\u4E2D\u9078\u64C7`),r}}if(Math.random()<this.AI_PERSONALITY.CREATIVE*.2){let o=this.findCreativeMoves(e,t);if(o.length>0){let n=o[Math.floor(Math.random()*o.length)];return console.log("\u{1F916} AI\u5617\u8A66\u5275\u610F\u8D70\u6CD5"),n}}return i}findCreativeMoves(e,i){let t=[];for(let o of i){let n=e.board[o.from.y][o.from.x];if(!n)continue;let s=!1;n.color==="black"&&o.to.y>6&&(s=!0),(n.type==="elephant"||n.type==="advisor")&&Math.abs(o.to.y-(n.color==="black"?0:9))>3&&(s=!0),o.capturedPiece&&this.PIECE_VALUES[n.type]>this.PIECE_VALUES[o.capturedPiece.type]*1.5&&(s=!0),s&&t.push(o)}return t}getAllPossibleMoves(e,i){let t=[];for(let o=0;o<10;o++)for(let n=0;n<9;n++){let s=e.board[o][n];if(s&&s.color===i){let r=this.chessGameService.getPossibleMoves(s,e.board);for(let a of r){let c=e.board[a.y][a.x];this.wouldMoveCauseSelfCheck(e,s.position,a)||t.push({from:s.position,to:a,score:0,capturedPiece:c||void 0})}}}return t}wouldMoveCauseSelfCheck(e,i,t){let o=e.board,n=o[i.y][i.x];if(!n)return!0;let s=o[t.y][t.x],r=n.position;o[t.y][t.x]=n,o[i.y][i.x]=null,n.position=t;let a=this.chessGameService.isInCheck(o,n.color);return o[i.y][i.x]=n,o[t.y][t.x]=s,n.position=r,a}simulateMove(e,i){let t=e.board.map(n=>n.map(s=>s?_(g({},s),{position:g({},s.position)}):null)),o=t[i.from.y][i.from.x];return o&&(t[i.to.y][i.to.x]=o,t[i.from.y][i.from.x]=null,o.position=g({},i.to)),_(g({},e),{board:t,currentPlayer:e.currentPlayer==="red"?"black":"red"})}evaluateBoard(e){let i=0;for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e.board[t][o];if(n){let s=this.PIECE_VALUES[n.type];s+=this.getSimplePositionBonus(n),n.color==="black"?i+=s:i-=s}}return this.chessGameService.isInCheck(e.board,"red")&&(i+=300),this.chessGameService.isInCheck(e.board,"black")&&(i-=300),i+=this.getBasicSafetyScore(e.board),i}getSimplePositionBonus(e){let{x:i,y:t}=e.position,o=0,n=Math.abs(t-4.5)+Math.abs(i-4);return o+=Math.max(0,(9-n)*2),e.type==="soldier"&&(e.color==="red"&&t<5||e.color==="black"&&t>4)&&(o+=30),o}getBasicSafetyScore(e){let i=0;for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e[t][o];if(n&&n.color==="black"){let s=this.PIECE_VALUES[n.type];s>=400&&this.isSimpleThreatened(o,t,n,e)&&(i-=Math.min(100,s*.2))}}return i}isSimpleThreatened(e,i,t,o){for(let n=0;n<10;n++)for(let s=0;s<9;s++){let r=o[n][s];if(r&&r.color==="red"&&this.chessGameService.getPossibleMovesForCheck(r,o).some(c=>c.x===e&&c.y===i))return!0}return!1}getPositionBonus(e){let{x:i,y:t}=e.position,o=0,n=Math.abs(t-4.5)+Math.abs(i-4);switch(o+=(9-n)*2,e.type){case"horse":t>=2&&t<=7&&i>=1&&i<=7&&(o+=30);break;case"cannon":(i===4||t===(e.color==="red"?7:2))&&(o+=20);break;case"soldier":if(e.color==="red"&&t<5||e.color==="black"&&t>4){o+=50;let r=e.color==="red"?4-t:t-5;o+=r*10}break}return o}getThreatScore(e,i,t,o){let n=0,s=t.color==="red"?"black":"red";for(let r=0;r<10;r++)for(let a=0;a<9;a++){let c=o[r][a];if(c&&c.color===s&&this.chessGameService.getPossibleMoves(c,o).some(v=>v.x===e&&v.y===i)){n-=this.PIECE_VALUES[t.type]*.5;break}}return n}getCenterControlScore(e){let i=0,t=[{x:3,y:4},{x:4,y:4},{x:5,y:4},{x:3,y:5},{x:4,y:5},{x:5,y:5}];for(let{x:o,y:n}of t){let s=e[n][o];s&&(s.color==="black"?i+=15:i-=15)}return i}getCheckScore(e){let i=0;return this.chessGameService.isInCheck(e,"red")&&(i+=100),this.chessGameService.isInCheck(e,"black")&&(i-=100),i}getDefenseScore(e){let i=0;for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e[t][o];if(n&&n.color==="black"){let s=this.PIECE_VALUES[n.type];if(s>=400){let r=this.isPieceProtected(o,t,n,e),a=this.isPieceThreatened(o,t,n,e);a&&!r?i-=s*.3:r&&a&&(i+=50)}}}return i+=this.getInterceptionScore(e),i+=this.getKingSafetyScore(e),i}isPieceProtected(e,i,t,o){for(let n=0;n<10;n++)for(let s=0;s<9;s++){let r=o[n][s];if(r&&r.color===t.color&&r!==t&&this.chessGameService.getPossibleMovesForCheck(r,o).some(c=>c.x===e&&c.y===i))return!0}return!1}isPieceThreatened(e,i,t,o){let n=t.color==="red"?"black":"red";for(let s=0;s<10;s++)for(let r=0;r<9;r++){let a=o[s][r];if(a&&a.color===n&&this.chessGameService.getPossibleMovesForCheck(a,o).some(h=>h.x===e&&h.y===i))return!0}return!1}getInterceptionScore(e){let i=0;for(let t=0;t<10;t++)for(let o=0;o<9;o++){let n=e[t][o];if(n&&n.color==="red"){let s=this.chessGameService.getPossibleMovesForCheck(n,e);for(let r of s){let a=e[r.y][r.x];a&&a.color==="black"&&this.PIECE_VALUES[a.type]>=400&&this.canCounterThreat(o,t,r.x,r.y,e)&&(i+=80)}}}return i}canCounterThreat(e,i,t,o,n){for(let s=0;s<10;s++)for(let r=0;r<9;r++){let a=n[s][r];if(a&&a.color==="black"){let c=this.chessGameService.getPossibleMovesForCheck(a,n);if(c.some(h=>h.x===e&&h.y===i)||c.some(h=>h.x===t&&h.y===o))return!0}}return!1}getKingSafetyScore(e){let i=0,t=null;for(let o=0;o<10&&!t;o++)for(let n=0;n<9&&!t;n++){let s=e[o][n];s&&s.color==="black"&&s.type==="king"&&(t=s)}if(t){let{x:o,y:n}=t.position,s=[{x:o-1,y:n-1},{x:o,y:n-1},{x:o+1,y:n-1},{x:o-1,y:n},{x:o+1,y:n},{x:o-1,y:n+1},{x:o,y:n+1},{x:o+1,y:n+1}],r=0;for(let c of s)if(c.x>=3&&c.x<=5&&c.y>=0&&c.y<=2){let h=e[c.y]?.[c.x];h&&h.color==="black"&&r++}i+=r*15;let a=0;for(let c=0;c<10;c++)for(let h=0;h<9;h++){let v=e[c][h];v&&v.color==="red"&&this.chessGameService.getPossibleMovesForCheck(v,e).some(S=>S.x===o&&S.y===n)&&a++}a>1?i-=200:a===1&&(i-=100)}return i}getThinkingDescription(e){let i=this.analyzeThreats(e),t=this.analyzeOpportunities(e),o=["\u6B63\u5728\u5206\u6790\u68CB\u5C40\u5F62\u52E2...","\u8A08\u7B97\u6700\u4F73\u79FB\u52D5\u8DEF\u7DDA...","\u8A55\u4F30\u653B\u9632\u5E73\u8861...","\u5C0B\u627E\u6230\u8853\u6A5F\u6703..."];return i.length>0&&o.push("\u767C\u73FE\u5A01\u8105\uFF0C\u6B63\u5728\u5236\u5B9A\u9632\u5B88\u7B56\u7565..."),t.length>0&&o.push("\u767C\u73FE\u653B\u64CA\u6A5F\u6703\uFF0C\u6B63\u5728\u8A08\u7B97..."),o[Math.floor(Math.random()*o.length)]}analyzeThreats(e){let i=[],t="black",o="red";if(this.chessGameService.isInCheck(e.board,t))for(let n=0;n<10;n++)for(let s=0;s<9;s++){let r=e.board[n][s];if(r&&r.type==="king"&&r.color===t){i.push({x:s,y:n});break}}return i}analyzeOpportunities(e){let i=[],t="black";return this.chessGameService.isInCheck(e.board,"red")&&i.push({x:4,y:9}),i}loadGameMemory(){try{if(typeof localStorage<"u"){let e=localStorage.getItem("chinese-chess-ai-memory");e&&(this.gameMemory=g(g({},this.gameMemory),JSON.parse(e)),console.log(`\u{1F916} AI\u8F09\u5165\u4E86${this.gameMemory.gameCount}\u5C40\u904A\u6232\u7684\u5B78\u7FD2\u6578\u64DA`))}}catch(e){console.warn("\u{1F916} AI\u5B78\u7FD2\u6578\u64DA\u8F09\u5165\u5931\u6557:",e)}}saveGameMemory(){try{typeof localStorage<"u"&&localStorage.setItem("chinese-chess-ai-memory",JSON.stringify(this.gameMemory))}catch(e){console.warn("\u{1F916} AI\u5B78\u7FD2\u6578\u64DA\u4FDD\u5B58\u5931\u6557:",e)}}learnFromPlayerMove(e,i,t){this.gameMemory.playerMoves.length>1e3&&this.gameMemory.playerMoves.shift();let o=this.evaluatePlayerMoveStyle(e,i,t);this.gameMemory.playerMoves.push({from:e,to:i,evaluation:o.score}),this.gameMemory.playerPreferences.aggressive+=o.aggressive*.1,this.gameMemory.playerPreferences.defensive+=o.defensive*.1,this.gameMemory.playerPreferences.positional+=o.positional*.1,Object.keys(this.gameMemory.playerPreferences).forEach(n=>{let s=n;this.gameMemory.playerPreferences[s]=Math.max(.1,Math.min(.9,this.gameMemory.playerPreferences[s]))}),this.saveGameMemory()}evaluatePlayerMoveStyle(e,i,t){let o=t.board[e.y][e.x],n=0,s=0,r=0;return o?(t.board[i.y][i.x]&&(n+=.8),i.y>5&&(n+=.6),i.y<3&&(s+=.7),(o.type==="advisor"||o.type==="elephant")&&(s+=.5),Math.abs(i.x-4)+Math.abs(i.y-4.5)<3&&(r+=.8),{score:n*.4+s*.3+r*.3,aggressive:n,defensive:s,positional:r}):{score:0,aggressive:0,defensive:0,positional:0}}learnFromGameEnd(e){this.gameMemory.gameCount++,console.log(e?"\u{1F916} AI\u5F9E\u5931\u6557\u4E2D\u5B78\u7FD2...":"\u{1F916} AI\u8A18\u9304\u52DD\u5229\u7D93\u9A57..."),this.adjustAIPersonality(),this.saveGameMemory()}adjustAIPersonality(){let e=this.gameMemory.playerPreferences;e.aggressive>.6&&(this.AI_PERSONALITY.CAUTIOUS=Math.min(.8,this.AI_PERSONALITY.CAUTIOUS+.1)),e.defensive>.6&&(this.AI_PERSONALITY.AGGRESSIVE=Math.min(.9,this.AI_PERSONALITY.AGGRESSIVE+.1)),console.log("\u{1F916} AI\u6839\u64DA\u73A9\u5BB6\u98A8\u683C\u8ABF\u6574\u4E86\u7B56\u7565",{player:e,aiPersonality:this.AI_PERSONALITY})}static \u0275fac=function(i){return new(i||l)(z(w))};static \u0275prov=B({token:l,factory:l.\u0275fac,providedIn:"root"})};var ae=()=>[0,1,2,3,4,5,6,7,8,9],le=()=>[0,1,2,3,4,5,6,7,8],oe=l=>({"valid-move-point":l});function ce(l,e){l&1&&(m(0,"span"),f(1,"\u{1F916}"),u())}function he(l,e){l&1&&(m(0,"div",13),f(1,"\u5C07\u8ECD\uFF01"),u())}function de(l,e){l&1&&(m(0,"div",14),f(1,"\u88AB\u5C07\u8ECD\uFF01"),u())}function ue(l,e){l&1&&f(0," AI \u601D\u8003\u4E2D... ")}function me(l,e){if(l&1&&(m(0,"div",22),f(1),u()),l&2){let i=e.$implicit;d(),P(" ",i," ")}}function fe(l,e){if(l&1&&(m(0,"div",25),f(1),u()),l&2){let i=e.$implicit;d(),P(" ",i," ")}}function ve(l,e){if(l&1&&b(0,"div",43)(1,"div",44),l&2){let i=e.$implicit;T(i===6?"z-20 h-[1.5px]":"z-10"),k("top",i*40+4,"px"),O("ngClass","sm:hidden"),d(),T(i===6?"z-20 h-[1.5px]":"z-10"),k("top",i*50+4,"px")}}function pe(l,e){if(l&1&&b(0,"div",45)(1,"div",45)(2,"div",46)(3,"div",46),l&2){let i=e.$implicit;k("left",i*36+14,"px")("top",4,"px")("height",157,"px"),d(),k("left",i*36+14,"px")("top",203,"px")("height",162,"px"),d(),k("left",i*50+4,"px")("top",4,"px")("height",200,"px"),d(),k("left",i*50+4,"px")("top",254,"px")("height",200,"px")}}function Ce(l,e){l&1&&b(0,"div",48)}function xe(l,e){l&1&&b(0,"div",48)}function ye(l,e){if(l&1&&(m(0,"div",49)(1,"div",56),f(2),u()()),l&2){let i=x().$implicit,t=x(2);O("ngClass",t.getPieceClass(i)),d(),T(i.color===t.PlayerColor.RED?"bg-red-100 border-red-600 text-red-800":"bg-neutral-100 border-neutral-800 text-neutral-800"),d(),P(" ",t.getPieceSymbol(i)," ")}}function ge(l,e){l&1&&b(0,"div",50)}function be(l,e){l&1&&b(0,"div",51)}function Pe(l,e){l&1&&b(0,"div",48)}function Me(l,e){l&1&&b(0,"div",48)}function _e(l,e){if(l&1&&(m(0,"div",53)(1,"div",57),f(2),u()()),l&2){let i=x().$implicit,t=x(2);O("ngClass",t.getPieceClass(i)),d(),T(i.color===t.PlayerColor.RED?"bg-red-100 border-red-600 text-red-800":"bg-neutral-100 border-neutral-800 text-neutral-800"),d(),P(" ",t.getPieceSymbol(i)," ")}}function Se(l,e){l&1&&b(0,"div",54)}function Ie(l,e){l&1&&b(0,"div",55)}function Ee(l,e){if(l&1){let i=V();m(0,"div",47),A("click",function(){let o=G(i).$index,n=x().$index,s=x();return N(s.onSquareClick(o,n))}),p(1,Ce,1,0,"div",48),p(2,xe,1,0,"div",48),p(3,ye,3,4,"div",49),p(4,ge,1,0,"div",50),p(5,be,1,0,"div",51),u(),m(6,"div",52),A("click",function(){let o=G(i).$index,n=x().$index,s=x();return N(s.onSquareClick(o,n))}),p(7,Pe,1,0,"div",48),p(8,Me,1,0,"div",48),p(9,_e,3,4,"div",53),p(10,Se,1,0,"div",54),p(11,Ie,1,0,"div",55),u()}if(l&2){let i=e.$implicit,t=e.$index,o=x().$index,n=x();k("top",o*40+4,"px")("left",t*36+14,"px"),O("ngClass",j(20,oe,n.isValidMove(t,o))),d(),C((o===2||o===7)&&(t===0||t===2||t===4||t===6||t===8)?1:-1),d(),C((o===3||o===6)&&(t===1||t===7)?2:-1),d(),C(i?3:-1),d(),C(n.isValidMove(t,o)&&!i?4:-1),d(),C(n.isValidMove(t,o)&&i&&i.color!==n.currentPlayer()?5:-1),d(),k("top",o*50+4,"px")("left",t*50+4,"px"),O("ngClass",j(22,oe,n.isValidMove(t,o))),d(),C((o===2||o===7)&&(t===0||t===2||t===4||t===6||t===8)?7:-1),d(),C((o===3||o===6)&&(t===1||t===7)?8:-1),d(),C(i?9:-1),d(),C(n.isValidMove(t,o)&&!i?10:-1),d(),C(n.isValidMove(t,o)&&i&&i.color!==n.currentPlayer()?11:-1)}}function ke(l,e){if(l&1&&I(0,Ee,12,24,null,null,F),l&2){let i=e.$implicit;E(i)}}function Ae(l,e){if(l&1&&(m(0,"div",25),f(1),u()),l&2){let i=e.$implicit;d(),P(" ",i," ")}}function De(l,e){if(l&1&&(m(0,"div",22),f(1),u()),l&2){let i=e.$implicit;d(),P(" ",i," ")}}function Oe(l,e){if(l&1){let i=V();m(0,"div",39)(1,"div",58)(2,"div",59),f(3,"\u{1F3C6}"),u(),m(4,"h2",60),f(5),u(),m(6,"button",61),A("click",function(){G(i);let o=x();return N(o.resetGame())}),f(7," \u91CD\u65B0\u958B\u59CB "),u()()()}if(l&2){let i=x();d(5),P(" ",i.winner()===i.PlayerColor.RED?"\u7D05\u65B9\u7372\u52DD\uFF01":"\u9ED1\u65B9\u7372\u52DD\uFF01"," ")}}function we(l,e){if(l&1&&(m(0,"span",67),f(1),u()),l&2){let i=x(2).$index,t=x(2);d(),$(t.moveHistory()[i+1])}}function Te(l,e){if(l&1&&(m(0,"div",5)(1,"span",65),f(2),u(),m(3,"span",66),f(4),u(),p(5,we,2,1,"span",67),u()),l&2){let i=x(),t=i.$implicit,o=i.$index,n=x(2);d(2),P("",n.Math.floor(o/2)+1,"."),d(2),$(t),d(),C(n.moveHistory()[o+1]?5:-1)}}function Re(l,e){if(l&1&&p(0,Te,6,3,"div",5),l&2){let i=e.$index;C(i%2===0?0:-1)}}function Be(l,e){if(l&1&&(m(0,"section",40)(1,"h3",62),f(2,"\u68CB\u8B5C\u8A18\u9304"),u(),m(3,"div",63)(4,"div",64),I(5,Re,1,1,null,null,F),u()()()),l&2){let i=x();d(5),E(i.moveHistory())}}var ne=class l{chessGameService=K(w);chessAIService=K(L);gameState=Y({board:[],currentPlayer:"red",selectedPiece:null,validMoves:[],gameOver:!1,winner:null,moveHistory:[],isInCheck:!1,isSelfInCheck:!1,isVsAI:!1,aiIsThinking:!1,aiThinkingText:""});board=y(()=>this.gameState().board);currentPlayer=y(()=>this.gameState().currentPlayer);selectedPiece=y(()=>this.gameState().selectedPiece);validMoves=y(()=>this.gameState().validMoves);gameOver=y(()=>this.gameState().gameOver);winner=y(()=>this.gameState().winner);moveHistory=y(()=>this.gameState().moveHistory);isInCheck=y(()=>this.gameState().isInCheck);isSelfInCheck=y(()=>this.gameState().isSelfInCheck);currentPlayerDisplay=y(()=>this.currentPlayer()==="red"?"\u7D05\u65B9":"\u9ED1\u65B9");isVsAI=y(()=>this.gameState().isVsAI);aiIsThinking=y(()=>this.gameState().aiIsThinking);aiThinkingText=y(()=>this.gameState().aiThinkingText);isAITurn=y(()=>this.isVsAI()&&this.currentPlayer()==="black"&&!this.gameOver());canInteract=y(()=>!this.isVsAI()||this.currentPlayer()==="red");PlayerColor=R;Math=Math;ngOnInit(){this.resetGame(!0)}resetGame(e=!1){let i=this.chessGameService.initializeGameState();i.isVsAI=e,this.gameState.set(i)}onSquareClick(e,i){if(this.gameOver()||!this.canInteract())return;let t=this.gameState(),o=t.board[i][e];t.selectedPiece?o&&o.color===t.currentPlayer&&o!==t.selectedPiece?this.selectPiece(o):this.isValidMove(e,i)?this.makeMove(t.selectedPiece.position,{x:e,y:i}):this.deselectPiece():o&&o.color===t.currentPlayer&&this.selectPiece(o)}selectPiece(e){let i=this.gameState();i.board.flat().forEach(o=>{o&&(o.isSelected=!1)}),e.isSelected=!0;let t=this.chessGameService.getPossibleMoves(e,i.board);this.gameState.set(_(g({},i),{selectedPiece:e,validMoves:t}))}deselectPiece(){let e=this.gameState();e.selectedPiece&&(e.selectedPiece.isSelected=!1),this.gameState.set(_(g({},e),{selectedPiece:null,validMoves:[]}))}isValidMove(e,i){return this.validMoves().some(t=>t.x===e&&t.y===i)}makeMove(e,i){let t=this.gameState(),o=t.board[e.y][e.x];if(!o)return;let n=this.chessGameService.makeMove(t,e,i);if(n.success){let s=this.generateMoveNotation(o,e,i,n.captured),r=[...t.moveHistory,s],a=t.currentPlayer==="red"?"black":"red",c=n.isCheck||!1,h=n.isSelfInCheck||!1,v=n.isCheckmate||n.isStalemate||n.gameOver||!1,M=n.winner||(n.isCheckmate?t.currentPlayer:null);if(t.board.flat().forEach(S=>{S&&(S.isSelected=!1)}),this.gameState.set(_(g({},t),{currentPlayer:a,selectedPiece:null,validMoves:[],moveHistory:r,isInCheck:c,isSelfInCheck:h,gameOver:v,winner:M})),t.isVsAI&&t.currentPlayer==="red"&&this.chessAIService.learnFromPlayerMove(e,i,t),v&&t.isVsAI){let S=M==="red";this.chessAIService.learnFromGameEnd(S)}console.log("\u6AA2\u67E5AI\u89F8\u767C\u689D\u4EF6:",{gameOver:v,isVsAI:t.isVsAI,nextPlayer:a,shouldTrigger:!v&&t.isVsAI&&a==="black"}),!v&&t.isVsAI&&a==="black"&&(console.log("\u6E96\u5099\u89F8\u767CAI\u79FB\u52D5..."),this.triggerAIMove())}}generateMoveNotation(e,i,t,o){if(!e)return"";let n=this.chessGameService.getPieceSymbol(e),s=e.color==="red"?9-i.x:i.x+1,r=t.y-i.y,a="";return r===0?a="\u5E73"+(e.color==="red"?9-t.x:t.x+1):a=(r<0?"\u9032":"\u9000")+Math.abs(r),`${n}${s}${a}`}getSquareClass(e,i){let t="chess-square";return this.board()[i]?.[e]?.isSelected&&(t+=" selected"),this.isValidMove(e,i)&&(t+=" valid-move"),(this.chessGameService.isInPalace(e,i,"red")||this.chessGameService.isInPalace(e,i,"black"))&&(t+=" palace"),t}getPieceClass(e){if(!e)return"";let i=`chess-piece ${e.color}`;return e.isSelected&&(i+=" selected"),i}getPieceSymbol(e){return e?this.chessGameService.getPieceSymbol(e):""}getRowNumbers(){return Array.from({length:10},(e,i)=>10-i)}getColumnLetters(){return["a","b","c","d","e","f","g","h","i"]}startVsAI(){let e=this.chessGameService.initializeGameState();e.isVsAI=!0,this.gameState.set(e)}startPvP(){let e=this.chessGameService.initializeGameState();e.isVsAI=!1,this.gameState.set(e)}toggleGameMode(){let e=this.gameState(),i=!e.isVsAI;this.gameState.set(_(g({},e),{isVsAI:i,aiIsThinking:!1})),i&&e.currentPlayer==="black"&&!e.gameOver&&this.triggerAIMove()}triggerAIMove(){let e=this.gameState();console.log("\u{1F916} \u89F8\u767CAI\u79FB\u52D5\uFF0C\u7576\u524D\u73A9\u5BB6:",e.currentPlayer),this.gameState.set(_(g({},e),{aiIsThinking:!0,aiThinkingText:this.chessAIService.getThinkingDescription(e)})),setTimeout(()=>{try{let i=this.chessAIService.makeAIMove(e);i?(console.log("\u{1F916} AI\u9078\u64C7\u79FB\u52D5:",i),this.makeAIMove(i.from,i.to)):(console.warn("\u{1F916} AI\u7121\u6CD5\u627E\u5230\u6709\u6548\u79FB\u52D5\uFF0CAI\u6295\u964D"),this.aiSurrender())}catch(i){console.error("\u{1F916} AI\u79FB\u52D5\u51FA\u932F:",i),this.aiSurrender()}},500)}makeAIMove(e,i){let t=this.gameState(),o=t.board[e.y][e.x];if(!o)return;let n=this.chessGameService.makeMove(t,e,i);if(n.success){let s=this.generateMoveNotation(o,e,i,n.captured),r=[...t.moveHistory,s],a="red",c=n.isCheck||!1,h=n.isSelfInCheck||!1,v=n.isCheckmate||n.isStalemate||n.gameOver||!1,M=n.winner||(n.isCheckmate?"black":null);t.board.flat().forEach(S=>{S&&(S.isSelected=!1)}),this.gameState.set(_(g({},t),{currentPlayer:a,selectedPiece:null,validMoves:[],moveHistory:r,isInCheck:c,isSelfInCheck:h,gameOver:v,winner:M,aiIsThinking:!1}))}}aiSurrender(){let e=this.gameState();console.log("\u{1F916} AI\u6295\u964D\uFF0C\u904A\u6232\u7D50\u675F"),this.gameState.set(_(g({},e),{gameOver:!0,winner:"red",aiIsThinking:!1,moveHistory:[...e.moveHistory,"\u{1F916} AI\u6295\u964D"]}))}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=W({type:l,selectors:[["app-chinese-chess"]],decls:85,vars:14,consts:[[1,"w-full","max-w-[95vw]","sm:max-w-sm","mx-auto","flex","flex-col","px-2","sm:px-0"],[1,"mb-2","flex","flex-col","gap-3","items-stretch"],[1,"flex","justify-between","items-center"],[1,"text-center","text-2xl","font-bold","tracking-wider","text-lime-400","drop-shadow"],["routerLink","/",1,"text-lime-600","text-sm"],[1,"flex","gap-2"],[1,"h-12","w-1/3","touch-btn","rounded-md","bg-cyan-700","border","border-cyan-500","text-cyan-50","font-semibold","text-base","shadow","hover:bg-cyan-600","focus:outline-none","focus:ring-2","focus:ring-cyan-300",3,"click"],[1,"h-12","w-1/3","touch-btn","rounded-md","bg-lime-700","border","border-lime-500","text-lime-50","font-semibold","text-base","shadow","hover:bg-lime-600","focus:outline-none","focus:ring-2","focus:ring-lime-300","drop-shadow-[0_0_5px_#22d3ee]",3,"click"],[1,"flex","flex-col","gap-2"],[1,"flex","items-center","gap-1","justify-between","flex-wrap","bg-white/10","rounded-md","p-2","border","border-white/20"],[1,"border","px-2","py-1","font-bold",3,"ngClass"],[1,"text-xs"],[1,"text-center","text-xs"],[1,"text-3xl","text-amber-300","animate-pulse"],[1,"text-3xl","text-red-400","animate-pulse"],[1,"py-3","border-1","border-lime-400","bg-lime-400/20","px-2","py-1","text-lime-300","font-bold","hover:bg-lime-400/30","transition",3,"click"],[1,"w-full","text-center","text-sm","mt-2","h-4","bg-neutral-700/80","rounded","overflow-hidden","relative","animate-pulse","text-white"],[1,"flex","justify-center"],[1,"relative","inline-block"],[1,"chess-board","bg-amber-100","border-2","sm:border-4","border-amber-800","p-2","sm:p-6","relative"],[1,"flex","justify-center","mb-1","sm:mb-2"],[1,"grid","grid-cols-9","gap-0"],[1,"w-[36px]","sm:w-[50px]","text-center","text-xs","font-bold","text-amber-800"],[1,"flex"],[1,"flex","flex-col","justify-center","mr-1","sm:mr-2"],[1,"h-[40px]","sm:h-[50px]","flex","items-center","justify-center","text-xs","font-bold","text-amber-800","w-4","sm:w-6"],[1,"relative","w-[310px]","h-[360px]","sm:w-[408px]","sm:h-[450px]","bg-amber-100"],["viewBox","0 0 100 100",1,"absolute","top-0","left-[122px]","w-[72px]","h-[80px]","sm:hidden"],["x1","0","y1","0","x2","100","y2","100","stroke","#d97706","stroke-width","1"],["x1","100","y1","0","x2","0","y2","100","stroke","#d97706","stroke-width","1"],["viewBox","0 0 100 100",1,"absolute","bottom-0","left-[122px]","w-[72px]","h-[80px]","sm:hidden"],["viewBox","0 0 100 100",1,"absolute","top-0","left-[154px]","w-[100px]","h-[100px]","hidden","sm:block"],["viewBox","0 0 100 100",1,"absolute","bottom-0","left-[154px]","w-[100px]","h-[100px]","hidden","sm:block"],[1,"absolute","left-0","right-0","bg-amber-100","flex","items-center","justify-between","px-8","z-5","sm:hidden",2,"top","161px","height","40px"],[1,"text-amber-700","font-bold","text-xs","tracking-wider"],[1,"absolute","left-0","right-0","bg-amber-100","flex","items-center","justify-between","px-16","z-5","hidden","sm:flex",2,"top","204px","height","50px"],[1,"text-amber-700","font-bold","text-sm","tracking-wider"],[1,"flex","flex-col","justify-center","ml-1","sm:ml-2"],[1,"flex","justify-center","mt-1","sm:mt-2"],[1,"absolute","inset-0","bg-black/50","backdrop-blur-sm","flex","items-center","justify-center","z-50","rounded-lg"],[1,"mt-6"],[1,"mt-4","text-xs","text-amber-600","text-center"],[1,"mb-1"],[1,"absolute","left-0","right-0","h-[1px]","bg-amber-800",3,"ngClass"],[1,"absolute","left-0","right-0","h-[1px]","bg-amber-800","hidden","sm:block"],[1,"absolute","w-[1px]","bg-amber-800","sm:hidden"],[1,"absolute","w-[1px]","bg-amber-800","hidden","sm:block"],[1,"absolute","w-[20px]","h-[20px]","-translate-x-1/2","-translate-y-1/2","rounded-full","hover:bg-amber-200/30","cursor-pointer","z-20","sm:hidden",3,"click","ngClass"],[1,"absolute","w-[6px]","h-[6px]","bg-amber-800","rounded-full","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-[32px]","h-[32px]",3,"ngClass"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-2","h-2","bg-green-500","rounded-full","opacity-70"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-[34px]","h-[34px]","border-2","border-red-500","rounded-full"],[1,"absolute","w-[24px]","h-[24px]","-translate-x-1/2","-translate-y-1/2","rounded-full","hover:bg-amber-200/30","cursor-pointer","z-20","hidden","sm:block",3,"click","ngClass"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-[40px]","h-[40px]",3,"ngClass"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-3","h-3","bg-green-500","rounded-full","opacity-70"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","w-[42px]","h-[42px]","border-2","border-red-500","rounded-full"],[1,"w-8","h-8","rounded-full","border-2","flex","items-center","justify-center","text-sm","font-bold","shadow-lg"],[1,"w-10","h-10","rounded-full","border-2","flex","items-center","justify-center","text-lg","font-bold","shadow-lg"],[1,"bg-gradient-to-br","from-amber-600","to-amber-800","border-2","border-amber-400","rounded-lg","p-8","shadow-2xl","text-center"],[1,"text-3xl","mb-4"],[1,"text-2xl","font-bold","mb-4","text-amber-100"],[1,"bg-amber-400","hover:bg-amber-300","text-amber-900","font-bold","py-3","px-6","rounded-lg","transition-all","duration-200","transform","hover:scale-105","shadow-lg",3,"click"],[1,"text-lg","font-bold","text-amber-400","mb-3"],[1,"bg-neutral-900/70","border","border-neutral-700","rounded-md","p-4","max-h-32","overflow-y-auto"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"text-neutral-400"],[1,"text-red-400"],[1,"text-neutral-300"]],template:function(i,t){i&1&&(m(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),f(4," \u4E2D\u570B\u8C61\u68CB "),u(),m(5,"a",4),f(6,"HOME"),u()(),m(7,"div",5)(8,"button",6),A("click",function(){return t.startPvP()}),f(9," \u{1F465} \u96D9\u4EBA\u5C0D\u6230 "),u(),m(10,"button",7),A("click",function(){return t.startVsAI()}),f(11," \u{1F916} \u4EBA\u6A5F\u5C0D\u6230 "),u(),m(12,"button",6),A("click",function(){return t.resetGame(!1)}),f(13," \u91CD\u65B0\u958B\u59CB "),u()(),m(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11),f(18,"\u7576\u524D\u56DE\u5408"),u(),m(19,"div",12),p(20,ce,2,0,"span"),f(21),u()(),p(22,he,2,0,"div",13),p(23,de,2,0,"div",14),m(24,"button",15),A("click",function(){return t.toggleGameMode()}),m(25,"div",12),f(26),u()(),m(27,"div",16),p(28,ue,1,0),u()()()(),m(29,"main",17)(30,"div",18)(31,"div",19)(32,"div",20)(33,"div",21),I(34,me,2,1,"div",22,D),u()(),m(36,"div",23)(37,"div",24),I(38,fe,2,1,"div",25,D),u(),m(40,"div",26),I(41,ve,2,9,null,null,D),I(43,pe,4,24,null,null,D),q(),m(45,"svg",27),b(46,"line",28)(47,"line",29),u(),m(48,"svg",30),b(49,"line",28)(50,"line",29),u(),m(51,"svg",31),b(52,"line",28)(53,"line",29),u(),m(54,"svg",32),b(55,"line",28)(56,"line",29),u(),U(),m(57,"div",33)(58,"span",34),f(59,"\u695A\u6CB3"),u(),m(60,"span",34),f(61,"\u6F22\u754C"),u()(),m(62,"div",35)(63,"span",36),f(64,"\u695A\u6CB3"),u(),m(65,"span",36),f(66,"\u6F22\u754C"),u()(),I(67,ke,2,0,null,null,F),u(),m(69,"div",37),I(70,Ae,2,1,"div",25,D),u()(),m(72,"div",38)(73,"div",21),I(74,De,2,1,"div",22,D),u()()(),p(76,Oe,8,1,"div",39),u()(),f(77),X(78,"json"),p(79,Be,7,0,"section",40),m(80,"footer",41)(81,"p",42),f(82,"\u9EDE\u64CA\u9078\u64C7\u68CB\u5B50\uFF0C\u518D\u9EDE\u64CA\u76EE\u6A19\u4F4D\u7F6E\u79FB\u52D5"),u(),m(83,"p"),f(84,"\u7D05\u65B9\u5148\u884C\uFF0C\u5C07\u8ECD\u5C0D\u65B9\u5373\u7372\u52DD"),u()()()),i&2&&(d(16),O("ngClass",t.currentPlayer()===t.PlayerColor.RED?"bg-red-500/20 border-red-400 text-red-300":"bg-neutral-800/20 border-neutral-400 text-neutral-300"),d(4),C(t.isVsAI()&&t.currentPlayer()===t.PlayerColor.BLACK?20:-1),d(),P("",t.currentPlayerDisplay()," "),d(),C(t.isInCheck()?22:-1),d(),C(t.isSelfInCheck()?23:-1),d(3),P(" ",t.isVsAI()?"\u5207\u63DB\u81F3\u96D9\u4EBA":"\u5207\u63DB\u81F3AI"," "),d(2),C(t.aiIsThinking()?28:-1),d(6),E(t.getColumnLetters()),d(4),E(t.getRowNumbers()),d(3),E(H(12,ae)),d(2),E(H(13,le)),d(24),E(t.board()),d(3),E(t.getRowNumbers()),d(4),E(t.getColumnLetters()),d(2),C(t.gameOver()?76:-1),d(),P(" ",J(78,10,t.moveHistory())," "),d(2),C(t.moveHistory().length>0?79:-1))},dependencies:[ee,Q,te,Z],styles:['.chess-board[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fed7aa);box-shadow:0 8px 32px #0000004d}.chess-square[_ngcontent-%COMP%]{position:relative;background:transparent;transition:all .2s ease}.chess-square[_ngcontent-%COMP%]:hover{background-color:#f59e0b1a}.chess-square.selected[_ngcontent-%COMP%]{background-color:#22c55e4d!important;border-color:#22c55e!important;box-shadow:inset 0 0 0 2px #22c55e}.chess-square.valid-move[_ngcontent-%COMP%]{background-color:#22c55e26!important}.chess-square.valid-move[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:12px;height:12px;background-color:#22c55e;border-radius:50%;opacity:.8}.chess-square.valid-move[_ngcontent-%COMP%]:hover:after{width:16px;height:16px;opacity:1}.chess-square.palace[_ngcontent-%COMP%]{background-color:#f59e0b0d}.chess-piece[_ngcontent-%COMP%]{transition:all .3s ease;z-index:10}.chess-piece.selected[_ngcontent-%COMP%]{transform:scale(1.1);filter:drop-shadow(0 0 8px rgba(34,197,94,.6))}.chess-piece.red[_ngcontent-%COMP%]   .piece-symbol[_ngcontent-%COMP%]{color:#dc2626;background:linear-gradient(135deg,#fecaca,#fee2e2);border-color:#dc2626}.chess-piece.black[_ngcontent-%COMP%]   .piece-symbol[_ngcontent-%COMP%]{color:#374151;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-color:#374151}.chess-piece[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.move-history[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#6b7280 #1f2937}.move-history[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.move-history[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937;border-radius:3px}.move-history[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280;border-radius:3px}.move-history[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@media (max-width: 640px){.chess-board[_ngcontent-%COMP%]{padding:1rem}.chess-board[_ngcontent-%COMP%]   .chess-square[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}.chess-board[_ngcontent-%COMP%]   .chess-piece[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:2rem;height:2rem;font-size:.875rem}}@keyframes _ngcontent-%COMP%_piece-capture{0%{transform:scale(1);opacity:1}50%{transform:scale(1.3);opacity:.7}to{transform:scale(0);opacity:0}}.captured[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_piece-capture .5s ease-out forwards}@keyframes _ngcontent-%COMP%_check-warning{0%,to{box-shadow:0 0 #ef4444b3}50%{box-shadow:0 0 0 10px #ef444400}}.in-check[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_check-warning 1s infinite}.valid-move-point.valid-move[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:10px;height:10px;background-color:#22c55e;border-radius:50%;opacity:.7}.valid-move-point[_ngcontent-%COMP%]:hover{background-color:#f59e0b33}']})};export{ne as ChineseChess};
